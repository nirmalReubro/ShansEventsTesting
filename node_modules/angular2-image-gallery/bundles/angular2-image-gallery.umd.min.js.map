{"version":3,"sources":["ng://angular2-image-gallery/lib/services/image.service.ts","ng://angular2-image-gallery/lib/gallery/gallery.component.ts","ng://angular2-image-gallery/lib/viewer/viewer.component.ts","ng://angular2-image-gallery/lib/angular2-image-gallery.module.ts"],"names":["ImageService","Subject","this","imagesUpdatedSource","asObservable","imageSelectedIndexUpdatedSource","showImageViewerSource","prototype","updateImages","images","next","updateSelectedImageIndex","newIndex","showImageViewer","show","Injectable","GalleryComponent","imageService","http","changeDetectorRef","undefined","EventEmitter","triggerCycle","event","scaleGallery","windowResize","render","ngOnInit","_this","fetchDataAndRender","viewerSubscription","showImageViewerChanged$","subscribe","visibility","viewerChange","emit","ngOnChanges","changes","ngOnDestroy","unsubscribe","openImageViewer","img","indexOf","navigate","direction","rowIndex","gallery","length","rowsPerPage","refreshNavigationErrorState","calcImageMargin","ratio","getGalleryWidth","Math","round","max","providedImageMargin","imageDataCompletePath","providedMetadataUri","providedGalleryName","imageDataStaticPath","dataFileName","get","data","forEach","image","err","console","error","tempRow","currentRowIndex","i","shouldAddCandidate","pop","imgRow","candidate","oldDifference","calcIdealHeight","calcRowHeight","push","newDifference","abs","originalRowWidth","calcOriginalRowWidth","minimalQualityCategory","individualRatio","providedImageSize","galleryContainer","nativeElement","clientWidth","scrollWidth","imageCounter","maximumGalleryImageHeight","slice","ratio_1","checkForAsyncLoading","width","height","detectChanges","imageElements","toArray","isScrolledIntoView","element","elementTop","getBoundingClientRect","top","elementBottom","bottom","window","innerHeight","leftArrowInactive","rightArrowInactive","Component","args","selector","template","styles","HttpClient","ChangeDetectorRef","Input","Output","ViewChild","ViewChildren","HostListener","ViewerComponent","imagesUpdated$","imageSelectedIndexUpdated$","currentIdx","transform","updateQuality","showViewer","math","Object","defineProperty","pan","swipe","deltaX","onResize","updateImage","showQualitySelector","qualitySelectorShown","qualityChanged","newQuality","qualitySelected","imageLoaded","hideNavigationArrows","showNavigationArrows","leftArrowVisible","rightArrowVisible","closeViewer","onKeydown","prevent","find","no","keyCode","preventDefault","setTimeout","screenWidth","innerWidth","screenHeight","categorySelected","host","(document:keydown)","animations","trigger","state","style","opacity","transition","animate","Angular2ImageGalleryModule","NgModule","imports","CommonModule","FormsModule","HttpClientModule","BrowserAnimationsModule","declarations","providers","exports"],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core'\nimport { Observable, Subject } from 'rxjs'\n\n@Injectable()\nexport class ImageService {\n    private imagesUpdatedSource = new Subject<Array<any>>()\n    private imageSelectedIndexUpdatedSource = new Subject<number>()\n    private showImageViewerSource = new Subject<boolean>()\n\n    imagesUpdated$: Observable<Array<any>> = this.imagesUpdatedSource.asObservable()\n    imageSelectedIndexUpdated$: Observable<number> = this.imageSelectedIndexUpdatedSource.asObservable()\n    showImageViewerChanged$: Observable<boolean> = this.showImageViewerSource.asObservable()\n\n    updateImages(images: Array<any>): void {\n        this.imagesUpdatedSource.next(images)\n    }\n\n    updateSelectedImageIndex(newIndex: number): void {\n        this.imageSelectedIndexUpdatedSource.next(newIndex)\n    }\n\n    showImageViewer(show: boolean): void {\n        this.showImageViewerSource.next(show)\n    }\n}\n","import {\n  ChangeDetectorRef, Component, ElementRef, EventEmitter, HostListener,\n  Input, OnChanges, OnDestroy, OnInit, Output, QueryList, SimpleChanges, ViewChild, ViewChildren\n} from '@angular/core'\nimport { ImageService } from '../services/image.service'\nimport { Subscription } from 'rxjs/internal/Subscription'\nimport { HttpClient } from '@angular/common/http'\n\n@Component({\n    selector: 'gallery',\n    template: `<div #galleryContainer class=\"galleryContainer\">\n    <div class=\"innerGalleryContainer\">\n        <div *ngFor='let imgrow of gallery | slice:rowIndex:rowIndex+rowsPerPage; let i = index'\n             class=\"imagerow\"\n             [style.margin-bottom.px]=\"calcImageMargin()\">\n            <img #imageElement\n                 *ngFor='let img of imgrow; let j = index'\n                 class=\"thumbnail\"\n                 [style.width.px]=\"img['width']\"\n                 [style.height.px]=\"img['height']\"\n                 (click)=\"openImageViewer(img)\"\n                 [src]=\"img['srcAfterFocus']\"\n                 [style.background]=\"img.dominantColor\"\n                 [style.margin-right.px]=\"calcImageMargin()\"/>\n        </div>\n    </div>\n\n    <div class=\"pagerContainer\" *ngIf=\"(!rightArrowInactive || !leftArrowInactive)\">\n        <img [ngClass]=\"{'inactive': leftArrowInactive}\" class=\"pager left\"\n             src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgaWQ9IkxheWVyXzEiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQ4IDQ4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNDggNDgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxnPjxwYXRoIGQ9Ik0yNCw0NkMxMS45LDQ2LDIsMzYuMSwyLDI0UzExLjksMiwyNCwyczIyLDkuOSwyMiwyMlMzNi4xLDQ2LDI0LDQ2eiBNMjQsNEMxMyw0LDQsMTMsNCwyNGMwLDExLDksMjAsMjAsMjAgICBjMTEsMCwyMC05LDIwLTIwQzQ0LDEzLDM1LDQsMjQsNHoiLz48L2c+PGc+PHBvbHlnb24gcG9pbnRzPSIyNy42LDM2LjcgMTQuOSwyNCAyNy42LDExLjMgMjkuMSwxMi43IDE3LjgsMjQgMjkuMSwzNS4zICAiLz48L2c+PC9zdmc+\"\n             (click)=\"navigate(-1)\"/>\n        <img [ngClass]=\"{'inactive': rightArrowInactive}\" class=\"pager right\"\n             src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgaWQ9IkxheWVyXzEiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDQ4IDQ4OyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgNDggNDgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxnPjxwYXRoIGQ9Ik0yNCw0NkMxMS45LDQ2LDIsMzYuMSwyLDI0UzExLjksMiwyNCwyczIyLDkuOSwyMiwyMlMzNi4xLDQ2LDI0LDQ2eiBNMjQsNEMxMyw0LDQsMTMsNCwyNHM5LDIwLDIwLDIwczIwLTksMjAtMjAgICBTMzUsNCwyNCw0eiIvPjwvZz48Zz48cG9seWdvbiBwb2ludHM9IjIxLjQsMzYuNyAxOS45LDM1LjMgMzEuMiwyNCAxOS45LDEyLjcgMjEuNCwxMS4zIDM0LjEsMjQgICIvPjwvZz48L3N2Zz4=\"\n             (click)=\"navigate(1)\"/>\n    </div>\n</div>\n\n<viewer></viewer>\n`,\n    styles: [`.innerGalleryContainer{position:relative}.galleryContainer{height:100%;width:100%;overflow:hidden}.innerGalleryContainer img:last-child{margin-right:-1px!important}.galleryContainer img:hover{-webkit-filter:brightness(50%);filter:brightness(50%);transition:all ease-out .2s;cursor:pointer}.imagerow{margin-right:1px;overflow:hidden;display:flex}::-webkit-scrollbar{display:none}.asyncLoadingContainer{position:absolute;background-color:transparent;height:0;width:0;bottom:120px}.pagerContainer{margin:40px auto;width:180px}.pager{display:block;height:60px}@media (max-width:700px){.pagerContainer{margin:40px auto;width:150px}.pager{display:block;height:45px}}.pager.inactive{opacity:.15}.pager.left{float:left}.pager.right{float:right}`]\n})\nexport class GalleryComponent implements OnInit, OnDestroy, OnChanges {\n    gallery: Array<any> = []\n    imageDataStaticPath: string = 'assets/img/gallery/'\n    imageDataCompletePath: string = ''\n    dataFileName: string = 'data.json'\n    images: Array<any> = []\n    minimalQualityCategory = 'preview_xxs'\n    viewerSubscription: Subscription\n    rowIndex: number = 0\n    rightArrowInactive: boolean = false\n    leftArrowInactive: boolean = false\n\n    @Input('flexBorderSize') providedImageMargin: number = 3\n    @Input('flexImageSize') providedImageSize: number = 7\n    @Input('galleryName') providedGalleryName: string = ''\n    @Input('metadataUri') providedMetadataUri: string = undefined\n    @Input('maxRowsPerPage') rowsPerPage: number = 200\n\n    @Output() viewerChange = new EventEmitter<boolean>()\n\n    @ViewChild('galleryContainer') galleryContainer: ElementRef\n    @ViewChildren('imageElement') imageElements: QueryList<any>\n\n    @HostListener('window:scroll', ['$event']) triggerCycle(event: any): void {\n        this.scaleGallery()\n    }\n\n    @HostListener('window:resize', ['$event']) windowResize(event: any): void {\n        this.render()\n    }\n\n    constructor(public imageService: ImageService, public http: HttpClient, public changeDetectorRef: ChangeDetectorRef) {\n    }\n\n    ngOnInit(): void {\n        this.fetchDataAndRender()\n        this.viewerSubscription = this.imageService.showImageViewerChanged$\n            .subscribe((visibility: boolean) => this.viewerChange.emit(visibility))\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        // input params changed\n        if (changes['providedGalleryName'] != undefined) {\n            this.fetchDataAndRender()\n        } else {\n            this.render()\n        }\n    }\n\n    ngOnDestroy(): void {\n        if (this.viewerSubscription) {\n            this.viewerSubscription.unsubscribe()\n        }\n    }\n\n    openImageViewer(img: any): void {\n        this.imageService.updateImages(this.images)\n        this.imageService.updateSelectedImageIndex(this.images.indexOf(img))\n        this.imageService.showImageViewer(true)\n    }\n\n    /**\n     * direction (-1: left, 1: right)\n     */\n    navigate(direction: number): void {\n        if ((direction === 1 && this.rowIndex < this.gallery.length - this.rowsPerPage)\n            || (direction === -1 && this.rowIndex > 0)) {\n            this.rowIndex += (this.rowsPerPage * direction)\n        }\n        this.refreshNavigationErrorState()\n    }\n\n    calcImageMargin(): number {\n        const galleryWidth = this.getGalleryWidth()\n        const ratio = galleryWidth / 1920\n        return Math.round(Math.max(1, this.providedImageMargin * ratio))\n    }\n\n    private fetchDataAndRender(): void {\n        this.imageDataCompletePath = this.providedMetadataUri\n\n        if (!this.providedMetadataUri) {\n            this.imageDataCompletePath = this.providedGalleryName !== '' ?\n                `${this.imageDataStaticPath + this.providedGalleryName}/${this.dataFileName}` :\n                this.imageDataStaticPath + this.dataFileName\n        }\n\n        this.http.get(this.imageDataCompletePath)\n          .subscribe(\n            (data: Array<any>) => {\n                    this.images = data\n                    this.imageService.updateImages(this.images)\n\n                    this.images.forEach(image => {\n                      image['galleryImageLoaded'] = false\n                      image['viewerImageLoaded'] = false\n                      image['srcAfterFocus'] = ''\n                    })\n                    // twice, single leads to different strange browser behaviour\n                    this.render()\n                    this.render()\n                },\n              err => {\n                    if (this.providedMetadataUri) {\n                      console.error(`Provided endpoint '${this.providedMetadataUri}' did not serve metadata correctly or in the expected format.\n      See here for more information: https://github.com/BenjaminBrandmeier/angular2-image-gallery/blob/master/docs/externalDataSource.md,\n      Original error: ${err}`)\n                    } else {\n                        console.error(`Did you run the convert script from angular2-image-gallery for your images first? Original error: ${err}`)\n                    }\n              },\n            () => undefined)\n    }\n\n    private render(): void {\n        this.gallery = []\n\n        let tempRow = [this.images[0]]\n        let currentRowIndex = 0\n        let i = 0\n\n        for (i; i < this.images.length; i++) {\n            while (this.images[i + 1] && this.shouldAddCandidate(tempRow, this.images[i + 1])) {\n                i++\n            }\n            if (this.images[i + 1]) {\n                tempRow.pop()\n            }\n            this.gallery[currentRowIndex++] = tempRow\n\n            tempRow = [this.images[i + 1]]\n        }\n\n        this.scaleGallery()\n    }\n\n    private shouldAddCandidate(imgRow: Array<any>, candidate: any): boolean {\n        const oldDifference = this.calcIdealHeight() - this.calcRowHeight(imgRow)\n        imgRow.push(candidate)\n        const newDifference = this.calcIdealHeight() - this.calcRowHeight(imgRow)\n\n        return Math.abs(oldDifference) > Math.abs(newDifference)\n    }\n\n    private calcRowHeight(imgRow: Array<any>): number {\n        const originalRowWidth = this.calcOriginalRowWidth(imgRow)\n\n        const ratio = (this.getGalleryWidth() - (imgRow.length - 1) * this.calcImageMargin()) / originalRowWidth\n        const rowHeight = imgRow[0][this.minimalQualityCategory]['height'] * ratio\n\n        return rowHeight\n    }\n\n    private calcOriginalRowWidth(imgRow: Array<any>): number {\n        let originalRowWidth = 0\n        imgRow.forEach(img => {\n            const individualRatio = this.calcIdealHeight() / img[this.minimalQualityCategory]['height']\n            img[this.minimalQualityCategory]['width'] = img[this.minimalQualityCategory]['width'] * individualRatio\n            img[this.minimalQualityCategory]['height'] = this.calcIdealHeight()\n            originalRowWidth += img[this.minimalQualityCategory]['width']\n        })\n\n        return originalRowWidth\n    }\n\n    private calcIdealHeight(): number {\n        return this.getGalleryWidth() / (80 / this.providedImageSize) + 100\n    }\n\n    private getGalleryWidth(): number {\n        if (this.galleryContainer.nativeElement.clientWidth === 0) {\n            // for IE11\n            return this.galleryContainer.nativeElement.scrollWidth\n        }\n        return this.galleryContainer.nativeElement.clientWidth\n    }\n\n    private scaleGallery(): void {\n        let imageCounter = 0\n        let maximumGalleryImageHeight = 0\n\n        this.gallery.slice(this.rowIndex, this.rowIndex + this.rowsPerPage)\n          .forEach(imgRow => {\n            const originalRowWidth = this.calcOriginalRowWidth(imgRow)\n\n            if (imgRow !== this.gallery[this.gallery.length - 1]) {\n                const ratio = (this.getGalleryWidth() - (imgRow.length - 1) * this.calcImageMargin()) / originalRowWidth\n\n                imgRow.forEach((img: any) => {\n                    img['width'] = img[this.minimalQualityCategory]['width'] * ratio\n                    img['height'] = img[this.minimalQualityCategory]['height'] * ratio\n                    maximumGalleryImageHeight = Math.max(maximumGalleryImageHeight, img['height'])\n                    this.checkForAsyncLoading(img, imageCounter++)\n                })\n            } else {\n                imgRow.forEach((img: any) => {\n                    img.width = img[this.minimalQualityCategory]['width']\n                    img.height = img[this.minimalQualityCategory]['height']\n                    maximumGalleryImageHeight = Math.max(maximumGalleryImageHeight, img['height'])\n                    this.checkForAsyncLoading(img, imageCounter++)\n                })\n            }\n        })\n\n        this.minimalQualityCategory = maximumGalleryImageHeight > 375 ? 'preview_xs' : 'preview_xxs'\n        this.refreshNavigationErrorState()\n\n        this.changeDetectorRef.detectChanges()\n    }\n\n    private checkForAsyncLoading(image: any, imageCounter: number): void {\n        const imageElements = this.imageElements.toArray()\n\n        if (image['galleryImageLoaded'] ||\n            (imageElements.length > 0 &&\n              imageElements[imageCounter] &&\n              this.isScrolledIntoView(imageElements[imageCounter].nativeElement))) {\n            image['galleryImageLoaded'] = true\n            image['srcAfterFocus'] = image[this.minimalQualityCategory]['path']\n        } else {\n            image['srcAfterFocus'] = ''\n        }\n    }\n\n    private isScrolledIntoView(element: any): boolean {\n        const elementTop = element.getBoundingClientRect().top\n        const elementBottom = element.getBoundingClientRect().bottom\n\n        return elementTop < window.innerHeight && elementBottom >= 0 && (elementBottom > 0 || elementTop > 0)\n    }\n\n    private refreshNavigationErrorState(): void {\n        this.leftArrowInactive = this.rowIndex == 0\n        this.rightArrowInactive = this.rowIndex > (this.gallery.length - this.rowsPerPage)\n    }\n}\n","import { ImageService } from '../services/image.service'\nimport { Component } from '@angular/core'\nimport { animate, state, style, transition, trigger } from '@angular/animations'\n\n@Component({\n    selector: 'viewer',\n    template: `<div class=\"outerContainer\" (window:resize)=\"onResize()\" *ngIf=\"showViewer\" [@showViewerTransition]=\"showViewer\">\n\n\n    <img [ngClass]=\"{'activeArrow': leftArrowActive}\" class=\"arrow left\"\n         src=\"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0cHgiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjx0aXRsZS8+PGRlc2MvPiAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgaWQ9Im1pdSIgc3Ryb2tlPSIjNTU1IiBzdHJva2Utd2lkdGg9IjAuMiI+ICAgICA8ZyBpZD0iQXJ0Ym9hcmQtMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTM5NS4wMDAwMDAsIC0xOTEuMDAwMDAwKSI+PGcgaWQ9InNsaWNlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTUuMDAwMDAwLCAxMTkuMDAwMDAwKSIvPjxwYXRoICAgICAgIGQ9Ik0zOTYsMjAyLjUgQzM5NiwxOTYuMTQ4NzI1IDQwMS4xNDg3MjUsMTkxIDQwNy41LDE5MSBDNDEzLjg1MTI3NSwxOTEgNDE5LDE5Ni4xNDg3MjUgNDE5LDIwMi41IEM0MTksMjA4Ljg1MTI3NSA0MTMuODUxMjc1LDIxNCA0MDcuNSwyMTQgQzQwMS4xNDg3MjUsMjE0IDM5NiwyMDguODUxMjc1IDM5NiwyMDIuNSBaIE00MDguNjU2ODU0LDE5Ni44NDMxNDYgTDQxMC4wNzEwNjgsMTk4LjI1NzM1OSBMNDA1LjgyODQyNywyMDIuNSBMNDEwLjA3MTA2OCwyMDYuNzQyNjQxIEw0MDguNjU2ODU0LDIwOC4xNTY4NTQgTDQwMywyMDIuNSBMNDA4LjY1Njg1NCwxOTYuODQzMTQ2IFoiICAgICAgIGZpbGw9IiNhYWEiICAgICAgIGlkPSJjaXJjbGUtYmFjay1hcnJvdy1nbHlwaCIvPjwvZz4gICA8L2c+IDwvc3ZnPg==\"\n         [hidden]=\"!leftArrowVisible\" (click)=\"navigate(-1, false)\"/>\n    <img [ngClass]=\"{'activeArrow': rightArrowActive}\" class=\"arrow right\"\n         src=\"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0cHgiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjx0aXRsZS8+PGRlc2MvPjxkZWZzLz4gICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGlkPSJtaXUiIHN0cm9rZT0iIzU1NSIgc3Ryb2tlLXdpZHRoPSIwLjIiPiAgICAgPGcgaWQ9IkFydGJvYXJkLTEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00NjcuMDAwMDAwLCAtMTkxLjAwMDAwMCkiPjxnIGlkPSJzbGljZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE1LjAwMDAwMCwgMTE5LjAwMDAwMCkiLz48cGF0aCAgICAgICBkPSJNNDY4LDIwMi41IEM0NjgsMTk2LjE0ODcyNSA0NzMuMTQ4NzI1LDE5MSA0NzkuNSwxOTEgQzQ4NS44NTEyNzUsMTkxIDQ5MSwxOTYuMTQ4NzI1IDQ5MSwyMDIuNSBDNDkxLDIwOC44NTEyNzUgNDg1Ljg1MTI3NSwyMTQgNDc5LjUsMjE0IEM0NzMuMTQ4NzI1LDIxNCA0NjgsMjA4Ljg1MTI3NSA0NjgsMjAyLjUgWiBNNDgwLjY1Njg1NCwxOTYuODQzMTQ2IEw0ODIuMDcxMDY4LDE5OC4yNTczNTkgTDQ3Ny44Mjg0MjcsMjAyLjUgTDQ4Mi4wNzEwNjgsMjA2Ljc0MjY0MSBMNDgwLjY1Njg1NCwyMDguMTU2ODU0IEw0NzUsMjAyLjUgTDQ4MC42NTY4NTQsMTk2Ljg0MzE0NiBaIiAgICAgICBmaWxsPSIjYWFhIiAgICAgICBpZD0iY2lyY2xlLW5leHQtYXJyb3ctZGlzY2xvc3VyZS1nbHlwaCIgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDc5LjUwMDAwMCwgMjAyLjUwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNDc5LjUwMDAwMCwgLTIwMi41MDAwMDApICIvPjwvZz4gICA8L2c+IDwvc3ZnPg==\"\n         [hidden]=\"!rightArrowVisible\" (click)=\"navigate(1, false)\"/>\n\n    <div class=\"buttonContainer\">\n        <img class=\"action close\"\n             src=\"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwcHgiIGlkPSJMYXllcl8xIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MTIgNTEyOyIgdmVyc2lvbj0iMS4xIiBmaWxsPSIjYWFhIiB2aWV3Qm94PSIwIDAgNTEyIDUxMiIgd2lkdGg9IjI0cHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPiAgPHBhdGggICAgc3Ryb2tlLXdpZHRoPSIzMCIgc3Ryb2tlPSIjNDQ0IiAgICBkPSJNNDM3LjUsMzg2LjZMMzA2LjksMjU2bDEzMC42LTEzMC42YzE0LjEtMTQuMSwxNC4xLTM2LjgsMC01MC45Yy0xNC4xLTE0LjEtMzYuOC0xNC4xLTUwLjksMEwyNTYsMjA1LjFMMTI1LjQsNzQuNSAgYy0xNC4xLTE0LjEtMzYuOC0xNC4xLTUwLjksMGMtMTQuMSwxNC4xLTE0LjEsMzYuOCwwLDUwLjlMMjA1LjEsMjU2TDc0LjUsMzg2LjZjLTE0LjEsMTQuMS0xNC4xLDM2LjgsMCw1MC45ICBjMTQuMSwxNC4xLDM2LjgsMTQuMSw1MC45LDBMMjU2LDMwNi45bDEzMC42LDEzMC42YzE0LjEsMTQuMSwzNi44LDE0LjEsNTAuOSwwQzQ1MS41LDQyMy40LDQ1MS41LDQwMC42LDQzNy41LDM4Ni42eiIvPjwvc3ZnPg==\"\n             (click)=\"closeViewer()\"/>\n    </div>\n\n    <div class=\"imageContainer\"\n         (click)=\"showNavigationArrows()\"\n         (swipeleft)=\"navigate(1, $event)\"\n         (swiperight)=\"navigate(-1, $event)\"\n         (pan)=\"pan($event)\">\n\n        <div *ngFor='let img of images; let j = index'\n             class=\"image\"\n             [class.active]=\"img['active']\"\n             [style.background-image]=\"img['viewerImageLoaded'] ? 'url('+img[categorySelected]['path']+')' : math.abs(currentIdx-j) <=1 ? 'url('+img['preview_xxs']['path']+')' : ''\"\n             [style.left]=\"transform+'px'\"\n             [@imageTransition]=\"img['transition']\"></div>\n\n        <img *ngFor='let img of images; let j = index'\n             class=\"preloading-image\"\n             (load)=\"imageLoaded(img)\"\n             src=\"{{ math.abs(currentIdx-j) <=1 ? img[categorySelected]['path'] : ''}}\"/>\n    </div>\n</div>\n\n`,\n    styles: [`.outerContainer{top:0;bottom:0;left:0;right:0;height:100%;width:100%;position:fixed;background-color:rgba(0,0,0,.95);font-family:sans-serif;z-index:1031}.imageContainer{position:absolute;float:none;top:0;bottom:0;left:0;right:0}.imageContainer .image,.imageContainer .preloading-image{visibility:hidden}.imageContainer .image.active{position:absolute;visibility:visible;background-repeat:no-repeat;background-size:contain;background-position:center;margin:auto;left:0;right:0;top:0;bottom:0;height:100%;width:100%;opacity:1}.arrow{opacity:0}.arrow:hover{cursor:pointer}.outerContainer:hover .arrow.activeArrow{height:calc(20px + 1.5vw);position:absolute;top:calc(50% - (20px + 1.5vw)/ 2);bottom:50%;z-index:1;opacity:1;transition:all ease-out .5s}.arrow.left{left:2vw}.arrow.right{right:2vw}.arrow:not(.activeArrow):hover{opacity:0;cursor:pointer;transition:all ease-out .5s}.buttonContainer{position:absolute;top:20px;right:20px;height:20px;text-align:center;opacity:1;z-index:200;transition:all ease-out .5s}.buttonContainer .action{height:100%;cursor:pointer;vertical-align:top}.buttonContainer .action:focus{outline:0}.buttonContainer .action:hover{background-color:#222;transition:all ease-out .3s}.buttonContainer .action.close{width:26px;height:26px}md-button-toggle.checked{background-color:#a0a0a0}.menuButton{position:absolute;bottom:20px;right:20px;text-align:center;opacity:1;z-index:200;transition:all ease-out .5s}@font-face{font-family:'Material Icons';font-style:normal;font-weight:400;src:local('Material Icons'),local('MaterialIcons-Regular'),url(https://fonts.gstatic.com/s/materialicons/v19/2fcrYFNaTjcS6g4U3t-Y5ZjZjT5FdEJ140U2DJYC3mY.woff2) format('woff2')}.material-icons{font-family:'Material Icons';font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:'liga';-webkit-font-smoothing:antialiased}`],\n    host: {\n        '(document:keydown)': 'onKeydown($event)'\n    },\n    animations: [\n        trigger('imageTransition', [\n            state('enterFromRight', style({\n                opacity: 1,\n                transform: 'translate(0px, 0px)'\n            })),\n            state('enterFromLeft', style({\n                opacity: 1,\n                transform: 'translate(0px, 0px)'\n            })),\n            state('leaveToLeft', style({\n                opacity: 0,\n                transform: 'translate(-100px, 0px)'\n            })),\n            state('leaveToRight', style({\n                opacity: 0,\n                transform: 'translate(100px, 0px)'\n            })),\n            transition('* => enterFromRight', [\n                style({\n                    opacity: 0,\n                    transform: 'translate(30px, 0px)'\n                }),\n                animate('250ms 500ms ease-in')\n            ]),\n            transition('* => enterFromLeft', [\n                style({\n                    opacity: 0,\n                    transform: 'translate(-30px, 0px)'\n                }),\n                animate('250ms 500ms ease-in')\n            ]),\n            transition('* => leaveToLeft', [\n                style({\n                    opacity: 1\n                }),\n                animate('250ms ease-out')]\n            ),\n            transition('* => leaveToRight', [\n                style({\n                    opacity: 1\n                }),\n                animate('250ms ease-out')]\n            )\n        ]),\n        trigger('showViewerTransition', [\n            state('true', style({\n                opacity: 1\n            })),\n            state('void', style({\n                opacity: 0\n            })),\n            transition('void => *', [\n                style({\n                    opacity: 0\n                }),\n                animate('1000ms ease-in')]\n            ),\n            transition('* => void', [\n                style({\n                    opacity: 1\n                }),\n                animate('500ms ease-out')]\n            )\n        ])\n    ]\n})\n\nexport class ViewerComponent {\n    showViewer: boolean\n    images: Array<any> = [{}]\n    currentIdx: number = 0\n    leftArrowVisible: boolean = true\n    rightArrowVisible: boolean = true\n    categorySelected: string = 'preview_xxs'\n    transform: number\n    math: Math\n    private qualitySelectorShown: boolean = false\n    private qualitySelected: string = 'auto'\n\n    constructor(private imageService: ImageService) {\n        imageService.imagesUpdated$.subscribe(\n            images => {\n                this.images = images\n            })\n        imageService.imageSelectedIndexUpdated$.subscribe(\n            newIndex => {\n                this.currentIdx = newIndex\n                this.images.forEach(image => image['active'] = false)\n                this.images[this.currentIdx]['active'] = true\n                this.transform = 0\n                this.updateQuality()\n            })\n        imageService.showImageViewerChanged$.subscribe(\n            showViewer => {\n                this.showViewer = showViewer\n            })\n        this.math = Math\n    }\n\n    get leftArrowActive(): boolean {\n        return this.currentIdx > 0\n    }\n\n    get rightArrowActive(): boolean {\n        return this.currentIdx < this.images.length - 1\n    }\n\n    pan(swipe: any): void {\n        this.transform = swipe.deltaX\n    }\n\n    onResize(): void {\n        this.images.forEach(image => {\n            image['viewerImageLoaded'] = false\n            image['active'] = false\n        })\n        this.updateImage()\n    }\n\n    showQualitySelector(): void {\n        this.qualitySelectorShown = !this.qualitySelectorShown\n    }\n\n    qualityChanged(newQuality: any): void {\n        this.qualitySelected = newQuality\n        this.updateImage()\n    }\n\n    imageLoaded(image: any): void {\n        image['viewerImageLoaded'] = true\n    }\n\n    /**\n     * direction (-1: left, 1: right)\n     * swipe (user swiped)\n     */\n    navigate(direction: number, swipe: any): void {\n        if ((direction === 1 && this.currentIdx < this.images.length - 1) ||\n            (direction === -1 && this.currentIdx > 0)) {\n\n            if (direction == -1) {\n                this.images[this.currentIdx]['transition'] = 'leaveToRight'\n                this.images[this.currentIdx - 1]['transition'] = 'enterFromLeft'\n            } else {\n                this.images[this.currentIdx]['transition'] = 'leaveToLeft'\n                this.images[this.currentIdx + 1]['transition'] = 'enterFromRight'\n            }\n            this.currentIdx += direction\n\n            if (swipe) {\n                this.hideNavigationArrows()\n            } else {\n                this.showNavigationArrows()\n            }\n            this.updateImage()\n        }\n    }\n\n    showNavigationArrows(): void {\n        this.leftArrowVisible = true\n        this.rightArrowVisible = true\n    }\n\n    closeViewer(): void {\n        this.images.forEach(image => image['transition'] = undefined)\n        this.images.forEach(image => image['active'] = false)\n        this.imageService.showImageViewer(false)\n    }\n\n    onKeydown(event: KeyboardEvent): void {\n        const prevent = [37, 39, 27, 36, 35]\n            .find(no => no === event.keyCode)\n        if (prevent) {\n            event.preventDefault()\n        }\n\n        switch (prevent) {\n            case 37:\n                // navigate left\n                this.navigate(-1, false)\n                break\n            case 39:\n                // navigate right\n                this.navigate(1, false)\n                break\n            case 27:\n                // esc\n                this.closeViewer()\n                break\n            case 36:\n                // pos 1\n                this.images[this.currentIdx]['transition'] = 'leaveToRight'\n                this.currentIdx = 0\n                this.images[this.currentIdx]['transition'] = 'enterFromLeft'\n                this.updateImage()\n                break\n            case 35:\n                // end\n                this.images[this.currentIdx]['transition'] = 'leaveToLeft'\n                this.currentIdx = this.images.length - 1\n                this.images[this.currentIdx]['transition'] = 'enterFromRight'\n                this.updateImage()\n                break\n            default:\n                break\n        }\n    }\n\n    private hideNavigationArrows(): void {\n        this.leftArrowVisible = false\n        this.rightArrowVisible = false\n    }\n\n    private updateImage(): void {\n        // wait for animation to end\n        setTimeout(() => {\n            this.updateQuality()\n            this.images[this.currentIdx]['active'] = true\n            this.images.forEach(image => {\n                if (image != this.images[this.currentIdx]) {\n                    image['active'] = false\n                    this.transform = 0\n                }\n            })\n        }, 500)\n    }\n\n    private updateQuality(): void {\n        const screenWidth = window.innerWidth\n        const screenHeight = window.innerHeight\n\n        switch (this.qualitySelected) {\n            case 'auto': {\n                this.categorySelected = 'preview_xxs'\n\n                if (screenWidth > this.images[this.currentIdx]['preview_xxs'].width &&\n                    screenHeight > this.images[this.currentIdx]['preview_xxs'].height) {\n                    this.categorySelected = 'preview_xs'\n                }\n                if (screenWidth > this.images[this.currentIdx]['preview_xs'].width &&\n                    screenHeight > this.images[this.currentIdx]['preview_xs'].height) {\n                    this.categorySelected = 'preview_s'\n                }\n                if (screenWidth > this.images[this.currentIdx]['preview_s'].width &&\n                    screenHeight > this.images[this.currentIdx]['preview_s'].height) {\n                    this.categorySelected = 'preview_m'\n                }\n                if (screenWidth > this.images[this.currentIdx]['preview_m'].width &&\n                    screenHeight > this.images[this.currentIdx]['preview_m'].height) {\n                    this.categorySelected = 'preview_l'\n                }\n                if (screenWidth > this.images[this.currentIdx]['preview_l'].width &&\n                    screenHeight > this.images[this.currentIdx]['preview_l'].height) {\n                    this.categorySelected = 'preview_xl'\n                }\n                if (screenWidth > this.images[this.currentIdx]['preview_xl'].width &&\n                    screenHeight > this.images[this.currentIdx]['preview_xl'].height) {\n                    this.categorySelected = 'raw'\n                }\n                break\n            }\n            case 'low': {\n                this.categorySelected = 'preview_xxs'\n                break\n            }\n            case 'mid': {\n                this.categorySelected = 'preview_m'\n                break\n            }\n            case 'high': {\n                this.categorySelected = 'raw'\n                break\n            }\n            default: {\n              this.categorySelected = 'preview_m'\n            }\n        }\n    }\n}\n","import { NgModule } from '@angular/core'\nimport { ImageService } from './services/image.service'\nimport { GalleryComponent } from './gallery/gallery.component'\nimport { ViewerComponent } from './viewer/viewer.component'\nimport { FormsModule } from '@angular/forms'\nimport { CommonModule } from '@angular/common'\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations'\nimport { HttpClientModule } from '@angular/common/http'\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    HttpClientModule,\n    BrowserAnimationsModule\n  ],\n  declarations: [\n    GalleryComponent,\n    ViewerComponent\n  ],\n  providers: [\n    ImageService\n  ],\n  exports: [\n    GalleryComponent,\n    ViewerComponent\n  ]\n})\nexport class Angular2ImageGalleryModule {\n}\n"]}